# ๐ ุชูุฑูุฑ ุดุงูู ุนู ุฌุฏูู ุงูุนููุงุก (Customer)

**ุงูุชุงุฑูุฎ**: 2025-10-08  
**ุงููุฏู**: ุงุณุชูุดุงู ุจููุฉ ุฌุฏูู ุงูุนููุงุกุ ุงุณุชุฎุฏุงููุ ูุชูุฏูู ุชูุตูุงุช

---

## ๐ 1. ุจููุฉ ุงูุฌุฏูู (Table Structure)

### ุงูุฃุนูุฏุฉ (Columns)

| ุงุณู ุงูุนููุฏ | ุงูููุน | NULL | ุงููุตู |
|-----------|-------|------|-------|
| `id` | INTEGER | NO | ุงููุนุฑู ุงููุฑูุฏ (Primary Key) |
| `name` | VARCHAR(100) | NO | ุงุณู ุงูุนููู (ูุทููุจ) |
| `phone` | VARCHAR(20) | YES | ุฑูู ุงููุงุชู |
| `address` | VARCHAR(200) | YES | ุงูุนููุงู |
| `email` | VARCHAR(100) | YES | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| `tax_id` | VARCHAR(50) | YES | ุงูุฑูู ุงูุถุฑูุจู (ููุดุฑูุงุช) |
| `customer_type` | VARCHAR(20) | YES | ููุน ุงูุนููู (ูุฑุฏ/ุดุฑูุฉ) |
| `notes` | TEXT | YES | ููุงุญุธุงุช ุนู ุงูุนููู |
| `is_active` | BOOLEAN | YES | ุญุงูุฉ ุงูุนููู (ูุดุท/ุบูุฑ ูุดุท) |
| `created_at` | DATETIME | YES | ุชุงุฑูุฎ ุงูุชุณุฌูู |

### ุงูููุงุฑุณ (Indexes)

- **`idx_customer_name`**: ููุฑุณ ุนูู ุนููุฏ `name` (ููุจุญุซ ุงูุณุฑูุน ุจุงูุงุณู)
- **`idx_customer_phone`**: ููุฑุณ ุนูู ุนููุฏ `phone` (ููุจุญุซ ุงูุณุฑูุน ุจุงููุงุชู)

---

## ๐ 2. ุงูุนูุงูุงุช ูุน ุงูุฌุฏุงูู ุงูุฃุฎุฑู

### Customer โ Orders (One-to-Many)

```
Customer (1) โโโโ (Many) Order
```

- **ุงูุนูุงูุฉ**: ุนููู ูุงุญุฏ ูููู ุฃู ูููู ูู ุนุฏุฉ ุทูุจุงุช
- **Foreign Key**: `order.customer_id` โ `customer.id`
- **Backref**: ูููู ุงููุตูู ููุทูุจุงุช ุนุจุฑ `customer.orders`
- **Cascade**: ุนูุฏ ุญุฐู ุนูููุ ูุง ุชูุญุฐู ุทูุจุงุชู (ูุญูุงูุฉ ุงูุจูุงูุงุช)

---

## ๐ป 3. ุงูุงุณุชุฎุฏุงู ูู ุงูููุฏ

### ุฃ) ูู ุงููููุฐุฌ (Model - `app.py`)

```python
class Customer(db.Model):
    __tablename__ = 'customer'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False, index=True)
    # ... ุจุงูู ุงูุญููู
    
    # ุงูุนูุงูุฉ ูุน ุงูุทูุจุงุช
    orders = db.relationship('Order', backref='customer', lazy=True)
```

### ุจ) ูู ุงููุณุงุฑุงุช (Routes)

#### 1. `/order/new` (ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ)

```python
# ุงูุจุญุซ ุนู ุนููู ููุฌูุฏ
customer = Customer.query.filter_by(
    name=customer_name, 
    phone=customer_phone
).first()

# ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุฅูุดุงุก ุนููู ุฌุฏูุฏ
if not customer:
    customer = Customer(
        name=customer_name,
        phone=customer_phone,
        address=customer_address
    )
    db.session.add(customer)
    db.session.flush()  # ููุญุตูู ุนูู customer.id
```

#### 2. `/order/<id>` (ุชูุงุตูู ุงูุทูุจ)

```python
order = db.get_or_404(Order, order_id)
# ุงููุตูู ูุจูุงูุงุช ุงูุนููู
customer_name = order.customer.name
customer_phone = order.customer.phone
```

### ุฌ) ูู ุงูููุงูุจ (Templates)

#### 1. `new_order.html` - ุฅุฏุฎุงู ุจูุงูุงุช ุงูุนููู

```html
<input type="text" name="customer_name" placeholder="ุงุณู ุงูุนููู" required>
<input type="text" name="customer_phone" placeholder="ูุงุชู ุงูุนููู">
<textarea name="customer_address" placeholder="ุนููุงู ุงูุนููู"></textarea>
```

#### 2. `order_detail.html` - ุนุฑุถ ุจูุงูุงุช ุงูุนููู

```html
<h5>{{ order.customer.name }}</h5>
<p>ุงููุงุชู: {{ order.customer.phone }}</p>
<p>ุงูุนููุงู: {{ order.customer.address }}</p>
```

#### 3. `orders.html` - ุนุฑุถ ุงูุนููู ูู ูุงุฆูุฉ ุงูุทูุจุงุช

```html
<td>{{ order.customer.name }}</td>
```

---

## ๐ 4. ุฅุญุตุงุฆูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุญุงููุงู)

- **ุฅุฌูุงูู ุงูุนููุงุก**: 1
- **ุนููุงุก ูุฏููู ุทูุจุงุช**: 1
- **ุนููุงุก ุจุฏูู ุทูุจุงุช**: 0

### ุฃูุซุฑ ุงูุนููุงุก ุทูุจุงู:
1. asm (9899): 1 ุทูุจ

---

## โ๏ธ 5. ููุงุญุธุงุช ูููุฉ

### โ ุงูุนููุงุก ูุดุชุฑููู ุจูู ุฌููุน ุงูุตุงูุงุช

**ุงููุฑุงุฑ ุงูุชุตูููู**:
- โ ูุง ููุฌุฏ `showroom_id` ูู ุฌุฏูู `customer`
- โ ูููู ูุฃู ุตุงูุฉ ุงูุจุญุซ ุนู ุฃู ุนููู
- โ ุงูุทูุจ ูู ุงูุฐู ูุญุฏุฏ ุงูุตุงูุฉุ ูููุณ ุงูุนููู

### ๐ฏ ุงูููุงุฆุฏ:

1. **ุชุฌูุจ ุงูุชูุฑุงุฑ**:
   - ุนููู ูุงุญุฏ ููููู ุงูุทูุจ ูู ุนุฏุฉ ุตุงูุงุช
   - ูุง ุญุงุฌุฉ ูุชุณุฌูู ููุณ ุงูุนููู ุนุฏุฉ ูุฑุงุช

2. **ุณูููุฉ ุงูุจุญุซ**:
   - ุงูุจุญุซ ุนู ุชุงุฑูุฎ ุงูุนููู ุนุจุฑ ุฌููุน ุงูุตุงูุงุช
   - ูุนุฑูุฉ ุฅุฌูุงูู ุทูุจุงุช ุงูุนููู ูู ุฌููุน ุงููุฑูุน

3. **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู**:
   - ุงูุนููู ุงููุณุฌู ูู ุตุงูุฉ A ููููู ูุจุงุดุฑุฉ ุงูุทูุจ ูู ุตุงูุฉ B
   - ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุฅุฏุฎุงู ุงูุจูุงูุงุช

### ๐ ุงูุญููู ุงููุณุชุฎุฏูุฉ ุญุงููุงู:

| ุงูุญูู | ุงูุญุงูุฉ | ุงูุงุณุชุฎุฏุงู |
|------|--------|-----------|
| `id` | โ ูุณุชุฎุฏู | ุงููุนุฑู ุงููุฑูุฏ |
| `name` | โ ูุณุชุฎุฏู | ุนุฑุถ ูู ูู ููุงู |
| `phone` | โ ูุณุชุฎุฏู | ุงูุจุญุซ ูุงูุชูุงุตู |
| `address` | โ ูุณุชุฎุฏู | ููุชูุตูู |
| `email` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |
| `tax_id` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |
| `customer_type` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |
| `notes` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |
| `is_active` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |
| `created_at` | โ ุบูุฑ ูุณุชุฎุฏู | ููุฌูุฏ ููู ูู ูููุนูู |

---

## ๐ 6. ุงูุญููู ุงูุฌุฏูุฏุฉ (ุบูุฑ ูุณุชุฎุฏูุฉ ุญุงููุงู)

ุงูุญููู ุงูุชุงููุฉ ููุฌูุฏุฉ ูู ุงููููุฐุฌ ููู **ูู ูุชู ุชูุนูููุง ูู ุงููุงุฌูุงุช**:

### 1. `email` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: ุฅุฑุณุงู ุฅุดุนุงุฑุงุชุ ููุงุชูุฑ ุฅููุชุฑูููุฉ
- **ุงูุชูุนูู**: ุฅุถุงูุฉ ุญูู ูู ูููุฐุฌ ุงูุทูุจ ุงูุฌุฏูุฏ

### 2. `tax_id` - ุงูุฑูู ุงูุถุฑูุจู
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: ููุนููุงุก ูู ููุน "ุดุฑูุฉ"
- **ุงูุชูุนูู**: ูุทููุจ ููููุงุชูุฑ ุงูุถุฑูุจูุฉ

### 3. `customer_type` - ููุน ุงูุนููู
- **ุงูููู**: "ูุฑุฏ" ุฃู "ุดุฑูุฉ"
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: ุชูุงุฑูุฑุ ููุชุฑุฉุ ูุนุงููุฉ ูุฎุชููุฉ

### 4. `notes` - ููุงุญุธุงุช
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: ููุงุญุธุงุช ุฎุงุตุฉ ุจุงูุนููู (ุชูุถููุงุชุ ุชุญุฐูุฑุงุช)
- **ุงูุชูุนูู**: ุญูู ูุตู ูู ูููุฐุฌ ุงูุนููู

### 5. `is_active` - ุญุงูุฉ ุงูุนููู
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: Soft Deleteุ ุฅุฎูุงุก ุนููุงุก ูุฏุงูู
- **ุงูุชูุนูู**: ุฒุฑ ุชูุนูู/ุชุนุทูู ูู ุฅุฏุงุฑุฉ ุงูุนููุงุก

### 6. `created_at` - ุชุงุฑูุฎ ุงูุชุณุฌูู
- **ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ**: ุชูุงุฑูุฑุ ุชุญูููุงุชุ ููุชุฑุฉ
- **ุงูุชูุนูู**: ุนุฑุถ ูู ุชูุงุตูู ุงูุนููู

---

## ๐ก 7. ุงูุชูุตูุงุช

### ุฃ) ุชูุนูู ุงูุญููู ุบูุฑ ุงููุณุชุฎุฏูุฉ

**ุงูุฃููููุฉ ุงูุนุงููุฉ**:
1. โ `email` - ููู ููุชูุงุตู ุงูุญุฏูุซ
2. โ `customer_type` - ููู ููููุงุชูุฑ ุงูุถุฑูุจูุฉ
3. โ `tax_id` - ูุทููุจ ููุดุฑูุงุช

**ุงูุฃููููุฉ ุงููุชูุณุทุฉ**:
4. `notes` - ูููุฏ ููููุงุญุธุงุช ุงูุฎุงุตุฉ
5. `created_at` - ูููุฏ ููุชูุงุฑูุฑ

**ุงูุฃููููุฉ ุงูููุฎูุถุฉ**:
6. `is_active` - ูู ุญุงู ุงูุญุงุฌุฉ ูู Soft Delete

### ุจ) ุฅุถุงูุงุช ููุชุฑุญุฉ ูููุงุฌูุงุช

#### 1. ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุนููุงุก (ุฌุฏูุฏุฉ)
```
/customers (ูุงุฆูุฉ ุงูุนููุงุก)
/customer/<id> (ุชูุงุตูู ุงูุนููู)
/customer/<id>/edit (ุชุนุฏูู ุจูุงูุงุช ุงูุนููู)
```

**ุงูููุฒุงุช**:
- ุนุฑุถ ุฌููุน ุงูุนููุงุก ูุน ููุชุฑุฉ ูุจุญุซ
- ุชูุงุตูู ุงูุนููู (ุจูุงูุงุช + ุชุงุฑูุฎ ุงูุทูุจุงุช)
- ุชุนุฏูู ุงูุจูุงูุงุช (email, tax_id, notes, etc)
- ุฅุญุตุงุฆูุงุช (ุฅุฌูุงูู ุงูุทูุจุงุชุ ุงููููุฉ ุงููููุฉ)

#### 2. ุชุญุณูู ูููุฐุฌ ุงูุทูุจ ุงูุฌุฏูุฏ
- ุฅุถุงูุฉ ุญูู `email` ููุนููู
- ุฅุถุงูุฉ ุงุฎุชูุงุฑ `customer_type` (ูุฑุฏ/ุดุฑูุฉ)
- ุฅุธูุงุฑ ุญูู `tax_id` ุฅุฐุง ูุงู customer_type = "ุดุฑูุฉ"

#### 3. ุชูุฑูุฑ ุงูุนููุงุก (ุฌุฏูุฏ)
- ุฃูุซุฑ ุงูุนููุงุก ุทูุจุงู
- ุงูุนููุงุก ุญุณุจ ุงููุชุฑุฉ ุงูุฒูููุฉ
- ุงูุนููุงุก ุญุณุจ ููุน (ูุฑุฏ/ุดุฑูุฉ)
- ูููุฉ ุงูุทูุจุงุช ููู ุนููู

### ุฌ) ุชุญุณููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

1. **ุฅุถุงูุฉ ูููุฏ (Constraints)**:
   ```sql
   CHECK (customer_type IN ('ูุฑุฏ', 'ุดุฑูุฉ'))
   ```

2. **ุฅุถุงูุฉ ููุฑุณ ุนูู email**:
   ```python
   email = db.Column(db.String(100), index=True)
   ```

3. **ุฌุนู phone ูุฑูุฏุงู (ุงุฎุชูุงุฑู)**:
   ```python
   phone = db.Column(db.String(20), unique=True)
   ```

---

## ๐ฏ 8. ููุฎุต

### ุงููุถุน ุงูุญุงูู โ
- ุจููุฉ ุฌุฏูู ุตุญูุญุฉ ููุชูุงููุฉ
- ุนูุงูุฉ ุณูููุฉ ูุน ุฌุฏูู ุงูุทูุจุงุช
- ูุดุงุฑูุฉ ุงูุนููุงุก ุจูู ุงูุตุงูุงุช (ุชุตููู ููุชุงุฒ)

### ูุง ูููุต โ๏ธ
- ูุงุฌูุงุช ูุฅุฏุงุฑุฉ ุงูุนููุงุก ุจุดูู ูููุตู
- ุชูุนูู ุงูุญููู ุงูุฅุถุงููุฉ (email, tax_id, etc)
- ุชูุงุฑูุฑ ุฎุงุตุฉ ุจุงูุนููุงุก

### ุงูุฎุทูุฉ ุงูุชุงููุฉ ๐
- ุฅูุดุงุก ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุนููุงุก
- ุชูุนูู ุญูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุฅุถุงูุฉ ุชูุฑูุฑ ุงูุนููุงุก ุงูุฃุณุงุณู

---

**ููุงุญุธุฉ**: ูุฐุง ุงูุชูุฑูุฑ ููุถุญ ุฃู ุฌุฏูู ุงูุนููุงุก ูุตูู ุจุดูู ููุชุงุฒ ูุฌุงูุฒ ููุฒูุฏ ูู ุงูุชูุณุนุ ููู ูุญุชุงุฌ ููุท ููุงุฌูุงุช ูุชูุนูู ุฅููุงููุงุชู ุงููุงููุฉ.

