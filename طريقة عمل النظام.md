# ุทุฑููุฉ ุนูู ุงููุธุงู - ูุธุงู ุฅุฏุงุฑุฉ ูุตูุน ุงููุทุงุจุฎ

## ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงูููู ูุญุชูู ุนูู ูุตู ุชูุตููู ูููููุฉ ุนูู ุงููุธุงูุ ูุนูุงุฑูุชูุ ูุงูููุงุนุฏ ุงูุฎุงุตุฉ ุจููููุงุชู ุงูุฃุณุงุณูุฉ.

---

## ูุธุงู ุฅุฏุงุฑุฉ ุงูุตุงูุงุช (Showroom Management System)

### ุงููุฏู
ุถูุงู ุฅุฏุงุฑุฉ ุดุงููุฉ ููุตุงูุงุช ูู ูุธุงู "ูุตู ุงูุตุงูุงุช" ูุชุญููู ุงูุนุฒู ุงููุงูู ููุจูุงูุงุช ูุงูุตูุงุญูุงุช ุจูู ุงูุตุงูุงุช ุงููุฎุชููุฉ.

---

### ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ) ุงููุงุฌูุฉ ุงูุฅุฏุงุฑูุฉ ๐ฅ๏ธ
- **ูุฌูุฏ CRUD ูุงูู**: ุฅุถุงูุฉุ ุนุฑุถุ ุชุนุฏููุ ุชุนุทูู ุงูุตุงูุงุช
- **ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ**: ููุงุฐุฌ ูุงุถุญุฉ ูููุธูุฉ
- **ุฅุญุตุงุฆูุงุช ุดุงููุฉ**: ุนุฑุถ ุจูุงูุงุช ูู ุตุงูุฉ ุจุดูู ููุตู
- **ุตูุงุญูุงุช ูุญููุฉ**: ุงููุฏูุฑูู ููุท ูููููู ุฅุฏุงุฑุฉ ุงูุตุงูุงุช

#### ุจ) ุงูุจูุงูุงุช ุงููุทููุจุฉ ๐

**ุงูุญููู ุงูุฅูุฒุงููุฉ**:
- โ ุงุณู ุงูุตุงูุฉ (ูุฑูุฏ)

**ุงูุญููู ุงูุงุฎุชูุงุฑูุฉ**:
- ๐ ููุฏ ุงูุตุงูุฉ (ูุตูุฑ ููุฑูุฏ)
- ๐ค ุงุณู ุงููุฏูุฑ
- ๐ ุฑูู ุงููุงุชู
- ๐ ุงูุนููุงู
- ๐ ููุงุญุธุงุช
- โก ุญุงูุฉ ุงูุชูุนูู (ูุดุท/ูุนุทู)

#### ุฌ) ุงููุณุงุฑุงุช ุงููุทููุจุฉ ๐ฃ๏ธ

```python
# 1. ุนุฑุถ ูุงุฆูุฉ ุงูุตุงูุงุช
@app.route('/showrooms')  # GET

# 2. ุฅุถุงูุฉ ุตุงูุฉ ุฌุฏูุฏุฉ
@app.route('/showroom/new')  # GET/POST

# 3. ุชุนุฏูู ุตุงูุฉ
@app.route('/showroom/<id>/edit')  # GET/POST

# 4. ุนุฑุถ ุชูุงุตูู ุตุงูุฉ
@app.route('/showroom/<id>')  # GET

# 5. ุชุนุทูู/ุชูุนูู ุตุงูุฉ
@app.route('/showroom/<id>/toggle_active')  # POST
```

#### ุฏ) ุงูููุงูุจ ุงููุทููุจุฉ ๐
- `showrooms.html` - ูุงุฆูุฉ ุงูุตุงูุงุช
- `new_showroom.html` - ูููุฐุฌ ุฅุถุงูุฉ ุตุงูุฉ
- `edit_showroom.html` - ูููุฐุฌ ุชุนุฏูู ุตุงูุฉ
- `showroom_detail.html` - ุชูุงุตูู ูุฅุญุตุงุฆูุงุช ุงูุตุงูุฉ

#### ูู) ุงูุฅุญุตุงุฆูุงุช ุงููุทููุจุฉ ๐

ููู ุตุงูุฉ ูุฌุจ ุนุฑุถ:
- ๐ข ุฅุฌูุงูู ุงูุทูุจุงุช (ุงูููุ ุงูููุชูุญุฉุ ุงูููุชููุฉ)
- ๐ฅ ุนุฏุฏ ุงูููุธููู (ุงูููุ ุงููุดุทูู)
- ๐ฆ ุนุฏุฏ ุงูููุงุฏ (ุงูููุ ุงููุดุทุฉ)
- ๐ฐ ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช
- ๐ณ ุนุฏุฏ ุงูุฏูุนุงุช
- ๐ ุขุฎุฑ ุงูุทูุจุงุช (ุขุฎุฑ 5-10)

#### ู) ุงูุชุญูู ูุงูุฃูุงู ๐

```python
# 1. ุงูุชุญูู ูู ุนุฏู ุงูุชูุฑุงุฑ
if Showroom.query.filter_by(name=name).first():
    flash('ุงุณู ุงูุตุงูุฉ ููุฌูุฏ ุจุงููุนู', 'danger')

# 2. ุงูุชุญูู ูู ุงูุตูุงุญูุฉ
if current_user.role != 'ูุฏูุฑ':
    flash('ููุณ ูุฏูู ุตูุงุญูุฉ', 'danger')

# 3. ุงูุชุญูู ูู ุนุฏู ุงูุญุฐู
if showroom.deleted_at:
    flash('ูุฐู ุงูุตุงูุฉ ูุญุฐููุฉ', 'danger')
```

#### ุฒ) ุงูุชูุงูู ูุน ุงููุธุงู ๐
- **ูู Sidebar**: ุฑุงุจุท "ุฅุฏุงุฑุฉ ุงูุตุงูุงุช" ูู ูุงุฆูุฉ ุงููุฏูุฑ
- **ูู ูููุฐุฌ ุงููุณุชุฎุฏู**: ุงุฎุชูุงุฑ ุงูุตุงูุฉ ุนูุฏ ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
- **ูู ูููุฐุฌ ุงูุทูุจ**: ุงุฎุชูุงุฑ ุงูุตุงูุฉ ุนูุฏ ุฅูุดุงุก ุทูุจ (ูููุฏูุฑูู)
- **ูู ุงูุชูุงุฑูุฑ**: ููุชุฑุฉ ุญุณุจ ุงูุตุงูุฉ

#### ุญ) ุงูููุงุฆุฏ โ
- **ุณูููุฉ ุงูุชูุณุน**: ุฅุถุงูุฉ ุตุงูุงุช ุฌุฏูุฏุฉ ุจุฏูู ุชุฏุฎู ูุฏูู
- **ุฑุคูุฉ ุดุงููุฉ**: ุงููุฏูุฑูู ูุฑูู ุฌููุน ุงูุตุงูุงุช ูุฅุญุตุงุฆูุงุชูุง
- **ูุฑููุฉ ุงูุฅุฏุงุฑุฉ**: ุชุนุทูู/ุชูุนูู ุงูุตุงูุงุช ุญุณุจ ุงูุญุงุฌุฉ
- **ุชูุธูู ุงูุจูุงูุงุช**: ูู ุตุงูุฉ ููุตููุฉ ุจุดูู ูุงูู

#### ุท) ููุงุญุธุงุช ูููุฉ โ๏ธ
- **ูุง ุชุณูุญ ุจุญุฐู ุตุงูุฉ** ููุง ุจูุงูุงุช ูุฑุชุจุทุฉ (ุงุณุชุฎุฏู Soft Delete)
- **ุชุฃูุฏ ูู ูุฌูุฏ ุตุงูุฉ ูุงุญุฏุฉ ุงูุชุฑุงุถูุฉ** ุนูู ุงูุฃูู
- **ุงุฎุชุจุฑ ุงูุตูุงุญูุงุช** ุจุดูู ุฌูุฏ ูููุน ุงูุชุณุฑูุจ ุจูู ุงูุตุงูุงุช
- **ูุซูู ุงูุชุบููุฑุงุช** ูู Change log ุนูุฏ ุฅุถุงูุฉ/ุชุนุฏูู ููุฒุงุช ุงูุตุงูุงุช

---

## ูุนูุงุฑูุฉ ุงููุธุงู (System Architecture)

### 1. ุทุจูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database Layer)

#### ุงูููุงุฐุฌ ุงูุฃุณุงุณูุฉ (Core Models):
- `Showroom` - ุฅุฏุงุฑุฉ ุงูุตุงูุงุช
- `User` - ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช
- `Customer` - ุงูุนููุงุก (ูุดุชุฑููู ุจูู ุงูุตุงูุงุช)
- `Order` - ุงูุทูุจุงุช (ูุฑุชุจุทุฉ ุจุตุงูุฉ ูุญุฏุฏุฉ)
- `Material` - ุงูููุงุฏ (ูุฑุชุจุทุฉ ุจุตุงูุฉ ูุญุฏุฏุฉ)
- `Payment` - ุงูุฏูุนุงุช
- `OrderCost` - ุงูุชูุงููู
- `Stage` - ูุฑุงุญู ุงูุทูุจ

#### ุงูุนูุงูุงุช ุงูุฑุฆูุณูุฉ:
```
Showroom (1) โโโโ (N) User
Showroom (1) โโโโ (N) Order
Showroom (1) โโโโ (N) Material
Order (1) โโโโ (N) Payment
Order (1) โโโโ (N) OrderCost
Order (N) โโโโ (1) Customer
```

### 2. ุทุจูุฉ ุงูููุทู (Business Logic Layer)

#### Helper Functions:
- `get_scoped_query(model, user)` - ุงูุนุฒู ุงูุชููุงุฆู ููุจูุงูุงุช
- `require_showroom_access(f)` - ุฏูููุฑูุชุฑ ููุญูุงูุฉ
- `get_user_showroom_id()` - ุงูุญุตูู ุนูู ุตุงูุฉ ุงููุณุชุฎุฏู
- `get_all_showrooms()` - ุฌูุจ ุฌููุน ุงูุตุงูุงุช

### 3. ุทุจูุฉ ุงูุนุฑุถ (Presentation Layer)

#### ุงูููุงูุจ (Templates):
- **ุงูููุงูุจ ุงูุฃุณุงุณูุฉ**: `base.html`, `dashboard.html`, `index.html`
- **ููุงูุจ ุงูุทูุจุงุช**: `orders.html`, `order_detail.html`, `new_order.html`
- **ููุงูุจ ุงูููุงุฏ**: `materials.html`, `new_material.html`, `edit_material.html`
- **ููุงูุจ ุงููุณุชุฎุฏููู**: `users.html`, `new_user.html`, `edit_user.html`
- **ููุงูุจ ุงูุตุงูุงุช**: `showrooms.html`, `new_showroom.html`, `edit_showroom.html`, `showroom_detail.html`
- **ููุงูุจ ุงูุชูุงุฑูุฑ**: `reports.html`, `reports/*.html`

---

## ูุจุงุฏุฆ ุงูุนุฒู ุจูู ุงูุตุงูุงุช

### 1. ุนุฒู ุงูุจูุงูุงุช (Data Isolation)
- ูู ุทูุจ ูุฑุชุจุท ุจุตุงูุฉ ูุงุญุฏุฉ ููุท
- ูู ูุงุฏุฉ ูุฑุชุจุทุฉ ุจุตุงูุฉ ูุงุญุฏุฉ ููุท
- ุฌููุน ุงูุนูููุงุช ุชุณุชุฎุฏู `showroom_id` ููููุชุฑุฉ

### 2. ุนุฒู ุงูุตูุงุญูุงุช (Permission Isolation)
- **ุงููุฏูุฑูู**: ูุตูู ูุงูู ูุฌููุน ุงูุตุงูุงุช
- **ููุธูู ุงูุงุณุชูุจุงู**: ูุตูู ูุตุงูุชูู ููุท
- **ุงูุชุญูู ุงูุชููุงุฆู**: ุงุณุชุฎุฏุงู `@require_showroom_access`

### 3. ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ (Shared Data)
- **ุงูุนููุงุก**: ูุดุชุฑููู ุจูู ุฌููุน ุงูุตุงูุงุช
- **ุงูุณุจุจ**: ุงูุนููู ูุฏ ูุฒูุฑ ุฃูุซุฑ ูู ุตุงูุฉ

---

## ุชุฏูู ุงูุนูููุงุช (Workflow)

### 1. ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
```
ุงููุณุชุฎุฏู ูุณุฌู ุงูุฏุฎูู
    โ
ุงุฎุชูุงุฑ ุงูุตุงูุฉ (ูููุฏูุฑูู) ุฃู ุงุณุชุฎุฏุงู ุตุงูุชู (ููููุธููู)
    โ
ุฅุฏุฎุงู ุจูุงูุงุช ุงูุทูุจ
    โ
ุญูุธ ุงูุทูุจ ูุน showroom_id
    โ
ุฅูุดุงุก ูุฑุงุญู ุงูุทูุจ ุชููุงุฆูุงู
```

### 2. ุงุณุชูุงู ุนุฑุจูู
```
ุงููุณุชุฎุฏู ููุชุญ ุชูุงุตูู ุงูุทูุจ
    โ
ุงุฎุชูุงุฑ "ุงุณุชูุงู ุนุฑุจูู"
    โ
ุฅุฏุฎุงู ูููุฉ ุงูุนุฑุจูู ูุทุฑููุฉ ุงูุฏูุน
    โ
ุญูุธ ุงูุฏูุนุฉ ูุน showroom_id ูู ุงูุทูุจ
    โ
ุชุญุฏูุซ ูุฑุญูุฉ "ุงุณุชูุงู ุงูุนุฑุจูู" ุฅูู 100%
    โ
ุฅุตุฏุงุฑ ุฅูุตุงู PDF ุชููุงุฆูุงู
```

### 3. ุฅุฏุงุฑุฉ ุงูุตุงูุงุช
```
ุงููุฏูุฑ ูุณุฌู ุงูุฏุฎูู
    โ
ุงูุงูุชูุงู ุฅูู "ุฅุฏุงุฑุฉ ุงูุตุงูุงุช"
    โ
ุนุฑุถ ูุงุฆูุฉ ุงูุตุงูุงุช ูุน ุงูุฅุญุตุงุฆูุงุช
    โ
ุฅุถุงูุฉ/ุชุนุฏูู/ุชุนุทูู ุงูุตุงูุงุช
```

---

## ุงูุฃูุงู ูุงูุญูุงูุฉ (Security)

### 1. ุญูุงูุฉ ุงููุณุงุฑุงุช
```python
@login_required  # ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
@require_showroom_access  # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุตูู ููุตุงูุฉ
def edit_order(order_id):
    # ...
```

### 2. Soft Delete
- ุงููุณุชุฎุฏููู ูุง ููุญุฐููู ูุนููุงูุ ุจู ููุนุทูููู (`is_active=False`)
- ุงูุตุงูุงุช ุชูุญุฐู ุจู Soft Delete (`deleted_at`)

### 3. Audit Trail
- ุชุชุจุน ุขุฎุฑ ุชุณุฌูู ุฏุฎูู (`last_login`)
- ุชุชุจุน ุชุญุฏูุซุงุช ุงูุฃุณุนุงุฑ (`price_updated_at`, `price_updated_by`)
- Timestamps ุชููุงุฆูุฉ (`created_at`, `updated_at`)

---

## ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช (Performance)

### Indexes ุงููุทุจูุฉ
```sql
-- ุนูู ุฌุฏูู orders
CREATE INDEX idx_showroom_status ON orders(showroom_id, status);
CREATE INDEX idx_showroom_date ON orders(showroom_id, order_date);
CREATE INDEX idx_customer_showroom ON orders(customer_id, showroom_id);

-- ุนูู ุฌุฏูู customers
CREATE INDEX idx_customer_phone ON customer(phone);
CREATE INDEX idx_customer_name ON customer(name);
```

### Best Practices
- ุงุณุชุฎุฏุงู `get_scoped_query()` ุจุฏูุงู ูู Query ูุฏููุฉ
- Lazy loading ููุนูุงูุงุช
- Pagination ููููุงุฆู ุงูุทูููุฉ

---

## ุงูุชูุณุนุงุช ุงููุณุชูุจููุฉ

### Phase 2 - ูุธุงู ุงูููุฑุฏูู
- ุฅุถุงูุฉ ูููุฐุฌ `Supplier`
- ุฅุถุงูุฉ ูููุฐุฌ `PurchaseInvoice`
- ุฑุจุท ุงูููุฑุฏูู ุจุงูุตุงูุงุช
- ุชุชุจุน ุงูููุงุชูุฑ ูุงููุฏููุนุงุช

### Phase 3 - ุงูุชูุงุฑูุฑ ุงููุชูุฏูุฉ
- ุชูุงุฑูุฑ ููุงุฑูุฉ ุจูู ุงูุตุงูุงุช
- ุชูุงุฑูุฑ ุงูุฃุฏุงุก ุงูุดูุฑูุฉ
- ุชุญูููุงุช ุงูุจูุงูุงุช
- Export ุฅูู Excel/PDF

### Phase 4 - ูุธุงู ุงูุฅุดุนุงุฑุงุช
- ุฅุดุนุงุฑุงุช ุงูุทูุจุงุช ุงููุชุฃุฎุฑุฉ
- ุฅุดุนุงุฑุงุช ููุต ุงูููุงุฏ
- ุฅุดุนุงุฑุงุช ุงูุฏูุนุงุช ุงููุณุชุญูุฉ

---

## ุงูุฎูุงุตุฉ

ูุธุงู ุฅุฏุงุฑุฉ ูุตูุน ุงููุทุงุจุฎ ูู ูุธุงู ุดุงูู ูููุฑ:
- โ ุนุฒู ูุงูู ุจูู ุงูุตุงูุงุช
- โ ุฅุฏุงุฑุฉ ูุชูุงููุฉ ููุทูุจุงุช ูุงูููุงุฏ
- โ ูุธุงู ุตูุงุญูุงุช ูุญูู
- โ ุชูุงุฑูุฑ ูุฅุญุตุงุฆูุงุช ุดุงููุฉ
- โ ูุงุฌูุฉ ูุณุชุฎุฏู ุนุตุฑูุฉ ูุณููุฉ

**ุงูุญุงูุฉ ุงูุญุงููุฉ**: ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ ูุน ุฌููุน ุงููููุฒุงุช ุงูุฃุณุงุณูุฉ ูุทุจูุฉ ููุฎุชุจุฑุฉ.

