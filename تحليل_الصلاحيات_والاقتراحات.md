# 📊 تحليل الصلاحيات الحالية والمقترحة - نظام إدارة مصنع المطابخ

**التاريخ:** 2025-10-18  
**الإصدار:** 1.0

---

## 📋 **الأدوار الموجودة في النظام:**

1. **مدير** (Admin)
2. **موظف استقبال** (Receptionist)
3. **مسؤول مخزن** (Warehouse Manager)
4. **مسؤول إنتاج** (Production Manager)
5. **مسؤول العمليات** (Operations Manager)

---

## 🔍 **التحليل الحالي للصلاحيات**

### **1️⃣ مدير**

#### **الصلاحيات الحالية:**
- ✅ **كل شيء** - صلاحية كاملة على جميع الوظائف
- ✅ الوصول لجميع الصالات
- ✅ إدارة المستخدمين
- ✅ إدارة الصالات
- ✅ أدوات المشرف
- ✅ جميع التقارير
- ✅ إعدادات النظام

#### **التقييم:**
✅ **مناسب تماماً** - لا يحتاج تعديل

---

### **2️⃣ موظف استقبال**

#### **الصلاحيات الحالية:**
- ✅ إضافة طلب جديد
- ✅ تعديل طلب (قبل مرحلة حصر المتطلبات فقط)
- ✅ استلام العربون
- ✅ إضافة دفعات
- ✅ رفع مستندات
- ❌ لا يصل إلا لصالته فقط

#### **المشاكل:**
- ⚠️ **لا يمكنه طباعة الفواتير** (قد يحتاجها)
- ⚠️ **لا يمكنه مراجعة تفاصيل الطلب بعد تقدمه**

#### **الاقتراحات:**
- ✅ إضافة صلاحية عرض تفاصيل الطلب (Read-only بعد حصر المتطلبات)
- ✅ إضافة صلاحية طباعة الفاتورة/عرض السعر
- ✅ إضافة صلاحية التواصل مع العميل (تحديث رقم الهاتف/العنوان)

---

### **3️⃣ مسؤول مخزن**

#### **الصلاحيات الحالية:**
- ✅ إدارة المواد (إضافة، تعديل، حذف)
- ✅ حصر متطلبات الطلب
- ✅ إدارة الموردين
- ✅ فواتير الشراء
- ✅ دفعات الموردين
- ✅ تقارير المواد
- ✅ تقارير المخزون
- ✅ **الوصول لجميع الصالات** ⭐ (محدث)

#### **المشاكل:**
- ⚠️ **لا يمكنه تعديل سعر مادة بعد ربطها بطلب** (قد يحتاجها للتصحيح)
- ⚠️ **لا يمكنه إلغاء طلب** (في حالة عدم توفر المواد)
- ⚠️ **لا صلاحية على المراحل** (لا يمكنه بدء مرحلة حصر المتطلبات)

#### **الاقتراحات:**
- ✅ إضافة صلاحية **بدء مرحلة "حصر متطلبات الطلب"**
- ✅ إضافة صلاحية **إكمال مرحلة "حصر متطلبات الطلب"**
- ✅ إضافة صلاحية **تعديل سعر مادة في الطلب** (مع audit log)
- ✅ إضافة صلاحية **اقتراح إلغاء طلب** (إشعار للمدير)
- ✅ إضافة صلاحية **جرد المخزون** (مطابقة المخزون الفعلي)

---

### **4️⃣ مسؤول إنتاج**

#### **الصلاحيات الحالية:**
- ✅ إدارة المواد (إضافة، تعديل، حذف)
- ✅ إدارة الموردين
- ✅ فواتير الشراء
- ✅ حصر متطلبات الطلب
- ✅ إدارة الفنيين
- ✅ **بدء مراحل الإنتاج** (تصنيع، تركيب)
- ✅ **تكليف الفنيين**
- ✅ **الوصول لجميع الصالات** ⭐ (محدث)

#### **المشاكل:**
- ⚠️ **صلاحيات متداخلة مع مسؤول المخزن** (إدارة المواد والموردين)
- ⚠️ **لا يمكنه تعديل المراحل بعد إكمالها** (في حالة خطأ)
- ⚠️ **لا يمكنه طباعة تقرير الإنتاج** (ملخص المراحل والفنيين)

#### **الاقتراحات:**
- ✅ **فصل الصلاحيات:**
  - ❌ إزالة صلاحية إدارة الموردين (تبقى لمسؤول المخزن فقط)
  - ✅ الاحتفاظ بصلاحية مراجعة المواد (Read-only)
- ✅ إضافة صلاحية **تعديل مرحلة مكتملة** (خلال 24 ساعة + audit log)
- ✅ إضافة صلاحية **طباعة تقرير الإنتاج**
- ✅ إضافة صلاحية **تقييم أداء الفنيين**
- ✅ إضافة صلاحية **جدولة الإنتاج** (تخطيط المراحل)

---

### **5️⃣ مسؤول العمليات**

#### **الصلاحيات الحالية:**
- ✅ مراجعة مراحل الطلب
- ✅ حصر متطلبات الطلب
- ✅ **الوصول لجميع الصالات** ⭐ (محدث)
- ⚠️ **صلاحيات محدودة جداً**

#### **المشاكل:**
- ❌ **غير واضح ما هو دوره بالضبط**
- ❌ **تداخل مع مسؤول الإنتاج ومسؤول المخزن**
- ❌ **لا يمكنه اتخاذ قرارات تشغيلية**

#### **الاقتراحات (إعادة تعريف الدور):**

**الخيار أ: مسؤول عمليات = مدير عمليات يومية**
- ✅ **مراقبة جميع الطلبيات** (dashboard كامل)
- ✅ **الموافقة على بدء المراحل** (workflow approval)
- ✅ **حل المشاكل العاجلة** (تبديل فني، تسريع طلب)
- ✅ **تقارير الأداء اليومي**
- ✅ **إدارة أولويات الطلبات**

**الخيار ب: مسؤول عمليات = مشرف ميداني**
- ✅ **متابعة الفنيين** (الموقع، الحضور، الأداء)
- ✅ **مراقبة الجودة** (فحص التصنيع والتركيب)
- ✅ **حل المشاكل الفنية** (استشارة، دعم)
- ✅ **تقارير الإنتاج اليومية**

---

## 📊 **جدول مقارنة شامل**

### **الطلبيات**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **عرض جميع الصالات** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ محدث | ✅ بقاء |
| **إضافة طلب** | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **تعديل طلب** | ✅ | ✅* | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **عرض تفاصيل طلب** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ صحيح | ✅ بقاء |
| **حذف طلب** | ✅ | ❌ | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **إلغاء طلب** | ✅ | ❌ | ❌ | ❌ | ⭐ | ❌ ناقص | ✅ **إضافة لمسؤول عمليات** |
| **طباعة فاتورة** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ ناقص | ✅ **إضافة لاستقبال** |

**ملاحظة:** ✅* = الاستقبال فقط قبل حصر المتطلبات

---

### **المراحل**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **عرض المراحل** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ صحيح | ✅ بقاء |
| **بدء مرحلة حصر المتطلبات** | ✅ | ❌ | ❌ | ✅ | ✅ | ⚠️ محدود | ✅ **إضافة لمخزن** |
| **إكمال حصر المتطلبات** | ✅ | ❌ | ❌ | ✅ | ✅ | ⚠️ محدود | ✅ **إضافة لمخزن** |
| **بدء مرحلة تصنيع** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **بدء مرحلة تركيب** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **تعديل مرحلة مكتملة** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ ناقص | ✅ **إضافة لإنتاج (24h)** |
| **إعادة فتح مرحلة** | ✅ | ❌ | ❌ | ❌ | ⭐ | ❌ ناقص | ✅ **إضافة لعمليات** |

---

### **المواد والمخزون**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **عرض المواد** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ صحيح | ⚠️ **إنتاج → Read-only** |
| **إضافة مادة** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **تعديل مادة** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **حذف مادة** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **تعديل سعر مادة في طلب** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ ناقص | ✅ **إضافة لمخزن** |
| **جرد المخزون** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ ناقص | ✅ **إضافة لمخزن** |
| **تنبيه نقص مواد** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ صحيح | ✅ بقاء |

---

### **الموردين والمشتريات**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **عرض الموردين** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **إضافة مورد** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **تعديل مورد** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **فاتورة شراء** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ⚠️ **مخزن: إنشاء / إنتاج: عرض** |
| **دفعة مورد** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ❌ **إزالة من إنتاج** |
| **تقرير ديون الموردين** | ✅ | ❌ | ✅ | ✅ | ❌ | ⚠️ تداخل | ⚠️ **مخزن: كامل / إنتاج: عرض** |

---

### **الفنيين**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **عرض الفنيين** | ✅ | ❌ | ❌ | ✅ | ⭐ | ⚠️ محدود | ✅ **إضافة لعمليات** |
| **إضافة فني** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **تعديل فني** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ⚠️ **عمليات: تعديل محدود** |
| **حذف فني** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **تكليف فني** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **مستحقات فني** | ✅ | ❌ | ❌ | ✅ | ⭐ | ⚠️ محدود | ✅ **إضافة لعمليات** |
| **دفع فني** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ صحيح | ✅ بقاء |
| **تقييم أداء فني** | ✅ | ❌ | ❌ | ❌ | ⭐ | ❌ ناقص | ✅ **إضافة لإنتاج وعمليات** |

---

### **الدفعات والإيصالات**

| العملية | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **استلام عربون** | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **استلام دفعة** | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **طباعة إيصال** | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **عرض الفواتير** | ✅ | ⭐ | ❌ | ❌ | ❌ | ❌ ناقص | ✅ **إضافة لاستقبال** |

---

### **التقارير**

| التقرير | مدير | استقبال | مخزن | إنتاج | عمليات | الحالة الحالية | الاقتراح |
|---------|------|----------|------|-------|--------|-----------------|----------|
| **طلبيات حسب الحالة** | ✅ | ⭐ | ✅ | ✅ | ✅ | ⚠️ محدود | ✅ **إضافة لاستقبال** |
| **ربحية الصالات** | ✅ | ❌ | ❌ | ❌ | ⭐ | ⚠️ محدود | ✅ **إضافة لعمليات** |
| **استهلاك المواد** | ✅ | ❌ | ✅ | ✅ | ⭐ | ✅ صحيح | ✅ **إضافة لعمليات** |
| **دوران المخزون** | ✅ | ❌ | ✅ | ❌ | ❌ | ✅ صحيح | ✅ بقاء |
| **أداء المنتجات** | ✅ | ❌ | ❌ | ✅ | ⭐ | ⚠️ محدود | ✅ **إضافة لعمليات** |
| **تقرير الإنتاج** | ✅ | ❌ | ❌ | ❌ | ⭐ | ❌ ناقص | ✅ **إضافة لإنتاج وعمليات** |
| **تقرير الفنيين** | ✅ | ❌ | ❌ | ✅ | ⭐ | ⚠️ محدود | ✅ **إضافة لعمليات** |

---

## 🎯 **التوصيات النهائية**

### **✅ تعديلات عاجلة (High Priority):**

#### **1. موظف الاستقبال:**
```
+ إضافة: عرض الفواتير (Read-only)
+ إضافة: طباعة الفاتورة/عرض السعر
+ إضافة: تقرير الطلبيات حسب الحالة (لصالته فقط)
```

#### **2. مسؤول المخزن:**
```
+ إضافة: بدء مرحلة "حصر متطلبات الطلب"
+ إضافة: إكمال مرحلة "حصر متطلبات الطلب"
+ إضافة: تعديل سعر مادة في طلب (مع audit log)
+ إضافة: وظيفة جرد المخزون
```

#### **3. مسؤول الإنتاج:**
```
- إزالة: إدارة الموردين (إضافة/تعديل/حذف)
- إزالة: إدارة المواد (إضافة/تعديل/حذف)
→ تحويل: عرض المواد والموردين (Read-only فقط)
+ إضافة: تعديل مرحلة مكتملة (خلال 24 ساعة + audit log)
+ إضافة: طباعة تقرير الإنتاج
+ إضافة: تقييم أداء الفنيين
```

#### **4. مسؤول العمليات:**
```
+ إعادة تعريف الدور: "مدير عمليات يومية"
+ إضافة: إلغاء طلب (مع سبب)
+ إضافة: إعادة فتح مرحلة مكتملة
+ إضافة: تقرير ربحية الصالات
+ إضافة: تقرير استهلاك المواد
+ إضافة: تقرير أداء المنتجات
+ إضافة: تقرير الإنتاج اليومي
+ إضافة: عرض مستحقات الفنيين
+ إضافة: تقرير الفنيين
```

---

### **⚠️ تعديلات متوسطة (Medium Priority):**

#### **1. فصل الصلاحيات بين الأدوار:**
```
مسؤول المخزن:
  - المواد (إضافة/تعديل/حذف) ✅
  - الموردين (إضافة/تعديل/حذف) ✅
  - فواتير الشراء (إنشاء/تعديل) ✅
  - جرد المخزون ✅

مسؤول الإنتاج:
  - المواد (عرض فقط) ✅
  - الموردين (عرض فقط) ✅
  - فواتير الشراء (عرض فقط) ✅
  - الفنيين (كامل) ✅
  - المراحل الإنتاجية (كامل) ✅
```

#### **2. إضافة Audit Log:**
```
- تعديل سعر مادة في طلب
- تعديل مرحلة مكتملة
- إلغاء طلب
- إعادة فتح مرحلة
- جرد المخزون
```

---

### **💡 تحسينات مستقبلية (Low Priority):**

1. **نظام الموافقات (Approval Workflow):**
   - موافقة مسؤول العمليات على بدء المراحل الحرجة
   - موافقة المدير على تعديل مراحل مكتملة
   - موافقة مسؤول المخزن على طلبات شراء كبيرة

2. **نظام الإشعارات:**
   - إشعار لمسؤول المخزن عند نقص مواد
   - إشعار لمسؤول الإنتاج عند اكتمال حصر المتطلبات
   - إشعار للاستقبال عند اكتمال الطلب

3. **Dashboard مخصص لكل دور:**
   - استقبال: طلبيات صالته + دفعات اليوم
   - مخزن: مواد ناقصة + طلبات شراء معلقة
   - إنتاج: مراحل قيد التنفيذ + أداء الفنيين
   - عمليات: KPIs + مراحل متأخرة + مشاكل

---

## 📋 **ملخص التغييرات المقترحة**

### **الإحصائيات:**

| الدور | صلاحيات حالية | صلاحيات مقترحة | تغيير |
|-------|---------------|-----------------|--------|
| موظف استقبال | 8 | **11** | +3 ✅ |
| مسؤول مخزن | 15 | **19** | +4 ✅ |
| مسؤول إنتاج | 18 | **15** | -3 ⚠️ (فصل) |
| مسؤول عمليات | 6 | **16** | +10 ✅ |

### **الأولويات:**

1. **عاجل** (الأسبوع القادم):
   - فصل صلاحيات المواد/الموردين بين المخزن والإنتاج
   - إضافة صلاحيات المراحل لمسؤول المخزن

2. **قريب** (الأسبوعين القادمين):
   - إعادة تعريف دور مسؤول العمليات
   - إضافة التقارير المقترحة

3. **مستقبلي** (الشهر القادم):
   - نظام الموافقات
   - نظام الإشعارات
   - Dashboards مخصصة

---

## ✅ **الخلاصة**

### **الهدف الرئيسي:**
تحقيق **فصل واضح** بين المسؤوليات:

```
موظف الاستقبال → التواصل مع العميل + الدفعات
مسؤول المخزن   → المواد + الموردين + المشتريات
مسؤول الإنتاج   → التصنيع + التركيب + الفنيين
مسؤول العمليات → المراقبة + التنسيق + حل المشاكل
```

### **الفوائد المتوقعة:**

1. ✅ **تقليل التداخل** بين الأدوار
2. ✅ **تحسين المساءلة** (كل شخص مسؤول عن نطاقه)
3. ✅ **زيادة الكفاءة** (كل شخص يركز على مهامه)
4. ✅ **تحسين الأمان** (صلاحيات أقل = أخطاء أقل)
5. ✅ **سهولة التدريب** (مهام واضحة لكل دور)

---

**📅 التاريخ:** 2025-10-18  
**✍️ المحلل:** AI Assistant  
**📊 الحالة:** جاهز للمراجعة والتطبيق

